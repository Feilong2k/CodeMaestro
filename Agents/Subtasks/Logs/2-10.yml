id: "2-10"
title: "REST API Endpoints"
status: pending
outcome: pending
branch: "subtask/2-10-rest-api-endpoints"
dependencies: ["2-2", "2-3", "2-5"]
relevantFiles:
  - "backend/src/routes/subtasks.js"
  - "backend/src/routes/agents.js"
  - "backend/src/routes/events.js"
requiredActions:
  - "GET /api/subtasks — List all subtasks"
  - "GET /api/subtasks/:id — Get subtask details + log"
  - "POST /api/subtasks/:id/start — Trigger workflow for subtask"
  - "POST /api/subtasks/:id/approve — Orion approves completion"
  - "GET /api/agents/status — Current state of each agent"
  - "GET /api/events — Recent event history"
verificationChecklist:
  - "[x] [TDD] Failing Unit Tests created (Red)"
  - "[ ] [TDD] Implementation satisfies Unit Tests (Green)"
  - "[ ] [TDD] Refactor pass (Cleanup)"
  - "[ ] [TDD] Integration Tests (Red → Green)"
  - "[ ] [TDD] Final verification and coverage > 80%"
  - "[ ] All endpoints respond correctly"
  - "[ ] Error cases handled"
  - "[ ] Dashboard can fetch data"
prChecklist:
  developer: []
  tester: []
prChecklistStatus:
  developer: pending
  tester: pending
  orchestrator: pending
openQuestions: []
notes:
  - "These endpoints wire the dashboard to the backend."
  - "⚠️ BRANCH CHECK: Run 'git branch' - must show * subtask/2-10-rest-api-endpoints"
  - "TARA INSTRUCTIONS (Create failing tests - Red):"
  - "  - Create backend/__tests__/unit/routes.test.js ✓"
  - "  - Test: GET /api/subtasks returns list ✓"
  - "  - Test: GET /api/subtasks/:id returns subtask + log ✓"
  - "  - Test: GET /api/subtasks/:id returns 404 for unknown id ✓"
  - "  - Test: POST /api/subtasks/:id/start triggers workflow ✓"
  - "  - Test: POST /api/subtasks/:id/approve marks complete ✓"
  - "  - Test: GET /api/agents/status returns agent states ✓"
  - "  - Test: GET /api/events returns recent events ✓"
  - "  - Test: Error responses have correct format ✓"
  - "  - Use supertest to test Express routes ✓"
  - "TESTS STATUS: 10 unit tests created. Tests are failing (Red) because route modules not implemented."
  - "---"
  - "DEVON INSTRUCTIONS (Make tests pass - Green):"
  - "  1. Create backend/src/routes/subtasks.js"
  - "  2. Create backend/src/routes/agents.js"
  - "  3. Create backend/src/routes/events.js"
  - "  4. Wire routes in backend/index.js"
  - "  5. Implement all endpoints using db and orchestrator services"
  - "  6. Run tests: cd backend; npm test -- --testPathPatterns=routes"
  - "⚠️ POWERSHELL REMINDER:"
  - "  - Do NOT use bash heredocs (<<'EOF'). They don't work in PowerShell!"
  - "  - Use ';' for sequential commands, NOT '&&'"
  - "  - To debug, create a temp .js file and run it, don't use inline scripts"
  - "  - Just run the test suite: npm test -- --testPathPatterns=routes"
lastUpdated: 2025-12-05T05:30:00Z
updatedBy: orion
